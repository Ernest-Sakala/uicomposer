<div class="ui-container">

<div class="component-library">
  <h3>Component Library</h3>
  <ng-container *ngFor="let component of availableComponents">
    <button *ngIf="component.type === 'button'" mat-raised-button (click)="addComponent(component)">
      {{ component.label }}
    </button>

    <div *ngIf="component.type === 'div'" (click)="addComponent(component)">
      {{ component.label }}
    </div>

    <mat-form-field *ngIf="component.type === 'input'" (click)="addComponent(component)">
      <input matInput placeholder="{{ component.label }}">
    </mat-form-field>

    <mat-checkbox *ngIf="component.type === 'checkbox'" (click)="addComponent(component)">
      {{ component.label }}
    </mat-checkbox>

    <mat-card *ngIf="component.type === 'mat-card'" (click)="addComponent(component)">
      {{ component.label }}
    </mat-card>

    <mat-grid-list cols="2" rowHeight="2:1"> </mat-grid-list>
    
  </ng-container>
</div>


<div class="property-editor" *ngIf="selectedComponent">
  <h3>Property Editor</h3>
  <mat-form-field appearance="outline">
    <mat-label>Background Color</mat-label>
    <input matInput [(ngModel)]="selectedComponent.styles.backgroundColor" (input)="updateComponentStyles('background-color', selectedComponent.styles.backgroundColor)">
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Width</mat-label>
    <input matInput [(ngModel)]="selectedComponent.styles.width" (input)="updateComponentStyles('width', selectedComponent.styles.width)">
  </mat-form-field>

  <mat-form-field appearance="outline">
    <mat-label>Height</mat-label>
    <input matInput [(ngModel)]="selectedComponent.styles.height" (input)="updateComponentStyles('height', selectedComponent.styles.height)">
  </mat-form-field>


</div>



 <div class="canvas">
  <h3>UI Builder</h3>
  
  <ng-container *ngFor="let component of canvasComponents; let i = index">
    
    <!-- Button Component -->
    <button
      *ngIf="component.type === 'button'"
      cdkDrag
      [ngStyle]="{
        left: component.position?.left + 'px',
        top: component.position?.top + 'px',
        backgroundColor: component.styles?.backgroundColor,
        width: component.styles?.width,
        height: component.styles?.height
      }"
      mat-raised-button
      (cdkDragMoved)="onDragMoved($event, i)"
      (cdkDragEnded)="onDragEnded(i)"
      (click)="selectComponent(component)"
    >
      {{ component.label }}
    </button>

    <!-- Card Component -->
    <mat-card
    *ngIf="component.type === 'card'"
      cdkDrag
      [ngStyle]="{
        left: component.position?.left + 'px',
        top: component.position?.top + 'px',
        backgroundColor: component.styles?.backgroundColor,
        width: component.styles?.width,
        height: component.styles?.height
      }"
      (cdkDragMoved)="onDragMoved($event, i)"
      (cdkDragEnded)="onDragEnded(i)"
      (click)="selectComponent(component)"
      appearance="outlined"
      class="example-card"
    >
    <ng-container *ngFor="let child of component.children">
      <!-- <ng-container *ngTemplateOutlet="renderComponent; context: { component: child }"></ng-container> -->
    </ng-container>
      
    </mat-card>

    <!-- Input Field Component -->
    <mat-form-field
      *ngIf="component.type === 'input'"
      cdkDrag
      [ngStyle]="{
        left: component.position?.left + 'px',
        top: component.position?.top + 'px',
        width: component.styles?.width
      }"
      (cdkDragMoved)="onDragMoved($event, i)"
      (cdkDragEnded)="onDragEnded(i)"
      (click)="selectComponent(component)"
    >
      <input matInput placeholder="{{ component.label }}" [(ngModel)]="component.properties.value">
    </mat-form-field>

    <!-- Checkbox Component -->
    <mat-checkbox
      *ngIf="component.type === 'checkbox'"
      cdkDrag
      [ngStyle]="{
        left: component.position?.left + 'px',
        top: component.position?.top + 'px',
        width: component.styles?.width,
        backgroundColor: component.styles?.backgroundColor
      }"
      (cdkDragMoved)="onDragMoved($event, i)"
      (cdkDragEnded)="onDragEnded(i)"
      (click)="selectComponent(component)"
    >
      {{ component.label }}
    </mat-checkbox>
  </ng-container>
</div>



  <!-- Right Panel: Code Editor -->
  <div class="code-editor">
    <h3>Generated Angular Code</h3>
    <mat-form-field appearance="outline" class="form-editor">
      <!-- <mat-label>Generated Code</mat-label> -->
      <textarea class="code-editor-area" matInput [(ngModel)]="generatedCode" rows="20" (input)="onCodeEdit()"></textarea>
    </mat-form-field>
<!-- 
    <button mat-raised-button color="primary" (click)="generateAngularCode()">Generate Angular Code</button> -->
  </div>

</div>